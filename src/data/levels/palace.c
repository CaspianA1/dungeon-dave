inlinable double palace_shader(const vec pos) {
	static const Circle
		first_health_kit = {{5.0, 2.0}, 1.0},
		first_downward_stairs = {{22.0, 24.0}, 5.0},
		torch = {{7.5, 12.5}, 1.0},
		hidden_area_circle_1 = {{2.5, 30.5}, 1.5},
		hidden_area_circle_2 = {{2.5, 26.5}, 1.5},
		hidden_area_circle_3 = {{5.0, 22.5}, 3.5};

	static const Triangle ravine_jump_entrance = {{15.0001, 24.0}, {15.5, 31.5}, {5.0, 28.0}};

	return
		bloom_circle(pos, first_health_kit) * 5.0
		+ bloom_circle(pos, first_downward_stairs) * 0.2
		+ bloom_circle(pos, torch) * 5.0
		+ bloom_circle(pos, hidden_area_circle_1) * 0.2
		+ bloom_circle(pos, hidden_area_circle_2) * 0.4
		+ bloom_circle(pos, hidden_area_circle_3) * 0.8
		+ flat_triangle(pos, ravine_jump_entrance) * 1.8
		+ fabs(sin(pos[0] - pos[1])) * sin(pos[0])
		+ 2.0;
}

void load_palace(void) {
	enum {
		map_width = 40, map_height = 40,
		wall_count = 10, billboard_count = 6, teleporter_count = 2,
		animated_billboard_count = 2, enemy_instance_count = 7
	};

	// in the horse area: a health kit, and the enemy
	static const byte wall_data[map_height][map_width] = {
		{1, 1, 1, 1, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 1, 0, 0, 1, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1, 0, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 1, 1, 1, 0, 0, 1, 0, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1, 0, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1, 0, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1, 0, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{1, 2, 2, 2, 2, 1, 1, 0, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,0, 0, 0, 1},
		{3, 2, 2, 2, 2, 1, 1, 0, 3, 5, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,8, 8, 8, 1},
		{3, 2, 2, 2, 2, 1, 1, 0, 3, 5, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,8, 8, 8, 1},
		{3, 2, 2, 2, 2, 0, 0, 0, 3, 5, 5, 2, 2, 2, 2, 5, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{3, 2, 2, 2, 2, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 10,0, 10,0, 10,0, 10,1},
		{3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 10,0, 10,0, 10,0, 10,1},
		{3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,10,10,10,10,10,10,0, 1},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 9, 9, 9, 9, 9, 9, 9, 9, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 10,0, 10,10,1},
		{1, 9, 8, 8, 8, 8, 8, 8, 9, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,0, 10,10,0, 0, 0, 0, 1},
		{1, 9, 8, 0, 0, 0, 0, 8, 9, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,0, 10,0, 0, 0, 0, 0, 1},
		{1, 9, 8, 0, 0, 0, 0, 8, 9, 3, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 10,0, 10,0, 0, 0, 0, 0, 1},
		{1, 9, 8, 0, 0, 0, 0, 8, 9, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 9, 8, 0, 8, 8, 8, 8, 9, 0, 0, 0, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 10,10,0, 10,10,10,0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 0, 6, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 6, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 10,10,0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 6, 7, 7, 7, 7, 7, 7, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 3, 10,0, 0, 10,0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 6, 7, 7, 6, 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 10,0, 0, 10,0, 10,0, 0, 0, 0, 1},
		{1, 0, 0, 0, 6, 7, 7, 6, 6, 6, 6, 6, 6, 0, 0, 6, 0, 6, 0, 6, 0, 6, 6, 6, 6, 6, 6, 6, 6, 10,10,10,10,0, 10,0, 10,0, 0, 1},
		{1, 0, 0, 0, 6, 7, 7, 6, 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 10,0, 0, 10,0, 10,0, 10,0, 0, 1},
		{1, 6, 6, 6, 6, 7, 7, 6, 2, 2, 2, 2, 6, 10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,0, 0, 0, 0, 10,0, 0, 0, 0, 1},
		{1, 6, 6, 6, 6, 7, 7, 6, 2, 2, 2, 2, 2, 10,10,10,10,10,10,10,10,10,10,2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{1, 0, 0, 0, 6, 7, 7, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{1, 0, 0, 0, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{1, 0, 0, 0, 6, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{1, 0, 0, 0, 6, 2, 2, 2, 2, 2, 2, 2, 2, 10,10,10,10,10,10,10,10,10,10,2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,10,10,10,10,10,10,10,10,10,2, 2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1},
		{10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10}
	};

	static const byte heightmap[map_height][map_width] = {
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5},
		{3, 0, 0, 3, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,10,10,10,10,0, 0, 0, 5},
		{3, 0, 0, 3, 0, 0, 3, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{3, 0, 0, 0, 0, 0, 3, 0, 6, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{3, 3, 3, 3, 0, 0, 3, 0, 6, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{3, 0, 0, 0, 0, 0, 3, 0, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{5, 0, 0, 0, 0, 0, 5, 0, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{5, 0, 0, 0, 0, 0, 5, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{5, 0, 0, 0, 0, 0, 5, 0, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{5, 1, 1, 1, 1, 5, 5, 0, 8, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 10,0, 10,10,10,10,10,0, 0, 0, 5},
		{6, 2, 2, 2, 2, 5, 5, 0, 6, 8, 2, 2, 2, 2, 2, 2, 2, 8, 2, 2, 2, 2, 8, 2, 2, 2, 2, 2, 6, 10,0, 10,10,10,10,10,1, 1, 1, 5},
		{6, 3, 3, 3, 3, 5, 5, 0, 6, 8, 3, 3, 3, 3, 3, 3, 8, 3, 3, 3, 3, 8, 2, 2, 2, 2, 2, 2, 6, 10,0, 10,10,10,10,10,1, 1, 1, 5},
		{6, 3, 3, 3, 3, 0, 0, 0, 6, 8, 8, 3, 3, 3, 3, 8, 3, 3, 3, 3, 8, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{6, 3, 3, 3, 3, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 3, 3, 3, 3, 8, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 10,0, 10,0, 10,0, 10,5},
		{6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 8, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 8, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 10,0, 10,0, 10,0, 10,5},
		{6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 8, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 8, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 10,10,10,10,10,10,10,0, 5},
		{6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{5, 2, 2, 2, 2, 2, 2, 2, 2, 6, 8, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 10,0, 10,10,5},
		{5, 2, 1, 1, 1, 1, 1, 1, 2, 6, 8, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 10,0, 10,10,0, 0, 0, 0, 5},
		{5, 2, 1, 0, 0, 0, 0, 1, 2, 6, 8, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 10,0, 10,0, 0, 0, 0, 0, 5},
		{5, 2, 1, 0, 0, 0, 0, 1, 2, 6, 8, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 10,0, 10,0, 0, 0, 0, 0, 5},
		{5, 2, 1, 0, 0, 0, 0, 1, 2, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3, 3, 3, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{5, 2, 1, 0, 1, 1, 1, 1, 2, 0, 0, 0, 3, 3, 2, 2, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 10,10, 0, 10,10,10, 0, 5},
		{5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{5, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 0, 0, 0, 0, 0, 0, 0, 5},
		{5, 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 10, 10, 0, 0, 0, 0, 0, 5},
		{5, 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 6, 10,0, 0, 10, 0, 0, 0, 0, 0, 0, 5},
		{5, 0, 0, 0, 3, 1, 1, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 10,0, 0, 10, 0, 10, 0, 0, 0, 0, 5},
		{5, 0, 0, 0, 3, 1, 1, 3, 3, 3, 3, 3, 3, 0, 0, 2, 0, 2, 0, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 10,10, 10, 10, 0, 10, 0, 10, 0, 0, 5},
		{5, 0, 0, 0, 3, 2, 2, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 10,0, 0, 10, 0, 10, 0, 10, 0, 0, 5},
		{5, 1, 2, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,10, 10, 10, 10, 0, 0, 0, 0, 10, 0, 0, 0, 0, 5},
		{5, 1, 2, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{5, 0, 0, 0, 3, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{5, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{5, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{5, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5},
		{10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10},
	};

	/* previous:
		{1.1, 1.1, 0.0}, {22.5, 16.0, 5.0}, {2.0, 2.0, 2.0}, {12.0, 37.0, 0.0},
		{15.5, 24.5, 2.0}, {2.5, 28.5, 2.0}, {37.5, 9.5, 5.0}, {3.5, 24.5, 0.0} */
	Level palace = init_level(map_width, map_height, 2.5, 28.5, 2.0);
	palace.max_point_height = 10;
	palace.out_of_bounds_point = 1;
	palace.background_sound = init_sound("assets/audio/themes/storm.wav", 0);
	palace.shader = palace_shader;

	const int bytes = map_width * map_height;
	memcpy(palace.wall_data, wall_data, bytes);
	memcpy(palace.heightmap, heightmap, bytes);
	memset(palace.ceiling_data, 1, bytes);
	memset(palace.floor_data, 1, bytes);

	fill_level_data(palace.floor_data, 5, 4, 6, 1, 3, map_height); // the flying carpet area
	fill_level_data(palace.floor_data, 7, 11, 13, 27, 29, map_height); // the entrance near the obstacle course
	fill_level_data(palace.floor_data, 6, 16, 22, 24, 30, map_height); // the sandstone around the pillars
	fill_level_data(palace.floor_data, 2, 1, 12, 24, 26, map_height); // part 1 of the hidden area's marble
	fill_level_data(palace.floor_data, 2, 1, 9, 19, 26, map_height); // part 2 of the aforementioned
	fill_level_data(palace.floor_data, 2, 1, 4, 25, 39, map_height); // part 3 of the aforementioned

	/* assets/skyboxes/desert.bmp
	assets/skyboxes/palace_city.bmp
	assets/skyboxes/desert_eyes.bmp */

	set_level_skybox(&palace, "assets/skyboxes/palace_city.bmp");

	set_level_walls(&palace, wall_count,
		"assets/walls/pyramid_bricks_3.bmp",
		"assets/walls/marble.bmp",
		"assets/walls/hieroglyph.bmp", // hieroglyphics.bmp

		"assets/walls/window.bmp",
		"assets/walls/saqqara.bmp",
		"assets/walls/sandstone.bmp",
		"assets/walls/cobblestone_3.bmp",
		"assets/walls/horses.bmp",
		"assets/walls/mesa.bmp",
		"assets/walls/arthouse_bricks.bmp");

	set_level_billboards(&palace, billboard_count,
		"assets/objects/health_kit.bmp", 4.5, 22.5, 0.0, // 11.5, 28.0
		"assets/objects/hot_dog.bmp", 16.5, 29.5, 0.0,
		"assets/objects/golden_dome.bmp", 13.0, 28.0, 1.0,
		"assets/objects/cactus.bmp", 1.5, 27.5, 0.0,
		"assets/objects/cactus.bmp", 2.5, 27.5, 1.0,
		"assets/objects/cactus.bmp", 3.5, 27.5, 2.0);

	set_level_teleporters(&palace, teleporter_count,
		8.5, 25.5, 0.0, // from pos + height
		2.0, 36.0, /* to pos */

		12.5, 38.5, 0.0, 2.0, 2.0);

	set_level_animated_billboards(&palace, animated_billboard_count,
		// "assets/spritesheets/bogo.bmp", 2, 3, 6, 3, 3.5, 7.0, 0.0,
		"assets/spritesheets/flying_carpet.bmp", 5, 10, 46, 25, 5.0, 2.0, 0.0,
		"assets/spritesheets/torch_2.bmp", 2, 3, 5, 12, 7.5, 12.5, 0.0);

	memcpy(&current_level, &palace, sizeof(Level));

	// this is set after b/c it depends on fns that read from current_level
	set_level_enemy_instances(&current_level, enemy_instance_count,
		0, 6.5, 21.5, 0.0,
		0, 3.5, 21.5, 0.0,
		0, 34.5, 19.5, 0.0,
		0, 31.0, 29.0, 0.0,
		0, 33.5, 26.5, 0.0,
		0, 37.5, 15.5, 0.0,
		0, 37.5, 5.5, 0.0);

	set_level_thing_container(&current_level);
}
