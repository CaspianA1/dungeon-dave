// this is a french castle: https://www.visit.alsace/wp-content/uploads/lei/pictures/219006223-fleckenstein-castle-6-1600x900.jpg

inlinable double fleckenstein_shader(const vec pos) {
	return pos[0] / 3.0;
}

void load_fleckenstein(void) {
	enum {
		map_width = 30, map_height = 30,
		wall_count = 4, billboard_count = 0, teleporter_count = 1,
		animated_billboard_count = 0, enemy_instance_count = 0
	};

	static const byte wall_data[map_height][map_width] = {
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 1, 1, 3, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 0, 0, 4, 4, 4, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 3, 3, 3, 3, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 4, 4, 4, 4, 4, 0, 0, 4, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 3, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 3, 1, 3, 3, 0, 0, 3, 3, 3, 3, 0, 0, 0, 3, 4, 4, 0, 4, 0, 4, 0, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 0, 3, 4, 0, 0, 0, 0, 0, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 0, 0, 3, 4, 0, 0, 4, 0, 4, 2},
		{2, 0, 0, 0, 3, 1, 1, 3, 3, 3, 3, 3, 3, 3, 1, 1, 3, 0, 3, 0, 3, 0, 0, 3, 4, 0, 0, 4, 0, 2},
		{2, 0, 0, 0, 3, 3, 3, 3, 0, 0, 0, 0, 0, 3, 1, 1, 3, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 4, 0, 2},
		{2, 0, 0, 0, 3, 3, 3, 3, 0, 0, 0, 0, 0, 3, 1, 1, 3, 0, 0, 0, 0, 3, 4, 4, 4, 4, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, 1, 3, 0, 0, 0, 3, 4, 4, 4, 4, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, 1, 3, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, 1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2},
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 1, 3, 1, 3, 0, 0, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2},
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2},
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2},
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2},
		{2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2}
	},

	heightmap[map_height][map_width] = {
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 6, 6, 6, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 6, 6, 6, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 5, 5, 9, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 0, 0, 6, 6, 6, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 9, 9, 9, 9, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 6, 6, 6, 6, 6, 0, 0, 6, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 9, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 6, 0, 0, 0, 0, 0, 0, 0, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 9, 5, 9, 9, 0, 0, 9, 9, 9, 9, 0, 0, 0, 9, 6, 6, 0, 6, 0, 6, 0, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 9, 0, 0, 0, 0, 9, 6, 0, 0, 0, 0, 0, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 9, 0, 0, 0, 0, 0, 9, 6, 0, 0, 6, 0, 6, 3},
		{3, 0, 0, 0, 9, 5, 5, 9, 9, 9, 9, 9, 9, 9, 5, 5, 9, 0, 9, 0, 9, 0, 0, 9, 6, 0, 0, 6, 0, 3},
		{3, 0, 0, 0, 9, 9, 9, 9, 0, 0, 0, 0, 0, 9, 5, 5, 9, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 6, 0, 3},
		{3, 0, 0, 0, 9, 9, 9, 9, 0, 0, 0, 0, 0, 9, 4, 4, 9, 0, 0, 0, 0, 9, 6, 6, 6, 6, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 3, 3, 9, 0, 0, 0, 9, 6, 6, 6, 6, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 2, 2, 6, 0, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 1, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 6, 5, 6, 5, 6, 0, 0, 5, 6, 5, 6, 5, 3, 3, 3, 3, 3, 3, 3, 3, 3},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3},
		{3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3}
	};

	Level fleckenstein = init_level(map_width, map_height, 13.0, 27.0, 0.0);

	set_level_skybox(&fleckenstein, "assets/skyboxes/mossy_mountains.bmp");
	fleckenstein.max_point_height = 9;

	fleckenstein.out_of_bounds_point = 1;
	fleckenstein.background_sound = init_sound("assets/audio/themes/ambient_wind.wav", 0);
	fleckenstein.shader = fleckenstein_shader;

	const int bytes = map_width * map_height;
	memcpy(fleckenstein.wall_data, wall_data, bytes);
	memcpy(fleckenstein.heightmap, heightmap, bytes);
	memset(fleckenstein.ceiling_data, 1, bytes);
	memset(fleckenstein.floor_data, 1, bytes);

	set_level_walls(&fleckenstein, wall_count,
		"assets/walls/stone_2.bmp",
		"assets/walls/cobblestone_3.bmp",
		"assets/walls/cobblestone_2.bmp",
		"assets/walls/marble.bmp");

	set_level_billboards(&fleckenstein, billboard_count);
	set_level_teleporters(&fleckenstein, teleporter_count, 9.5, 26.5, 0.0, 15.5, 6.5);

	set_level_animated_billboards(&fleckenstein, animated_billboard_count);

	memcpy(&current_level, &fleckenstein, sizeof(Level));
	set_level_enemy_instances(&current_level, enemy_instance_count);
	set_level_thing_container(&current_level);
}
